{"version":3,"file":"capsule-editor.umd.cjs","sources":["../src/EditorError.vue","../src/EditorFooter.vue","../src/EditorModal.vue","../src/EditorToolbar.vue","../src/Extensions/Lint.ts","../src/Extensions/Toolbar.ts","../src/Editor.vue"],"sourcesContent":["<script lang=\"ts\">\nimport { ArrowTopRightOnSquareIcon } from '@heroicons/vue/24/outline';\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n\n    components: {\n        ArrowTopRightOnSquareIcon\n    },\n\n    props: {\n\n        error: {\n            type: Object,\n            required: true\n        }\n\n    },\n\n    computed: {\n        url() {\n            return this.error.rule.link;\n        }\n    }\n    \n});\n</script>\n\n<template>\n    <div class=\"capsule-editor-error\">\n        <code>\n            <span>{{ error.line }},{{ error.col }} :: ({{ error.rule.id }}) {{ error.message }}</span>\n            <a\n                :href=\"url\"\n                target=\"_blank\">\n                Reference <ArrowTopRightOnSquareIcon />\n            </a>\n        </code>            \n    </div>\n</template>\n\n<style>\n.capsule-editor-error {\n    display: flex;\n    align-items: center;\n    animation-duration: .5s;\n    padding: .5rem .75rem;\n    gap: .5rem;\n}\n\n.capsule-editor-error code {\n    padding: 0 .25rem;\n}\n\n.capsule-editor-error a {\n    font-size: .85rem;\n    color: #e0e0e0;\n    padding-left: .5rem;\n    display: inline-flex;\n    align-items: center;\n    gap: .5rem;\n}\n.capsule-editor-error a svg {\n    width: 1rem;\n    height: 1rem;\n}\n</style>\n","<script lang=\"ts\">\nimport { forceLinting } from '@codemirror/lint';\nimport { BugAntIcon, ChevronLeftIcon, ChevronRightIcon, ExclamationTriangleIcon, WrenchScrewdriverIcon } from '@heroicons/vue/24/outline';\nimport { AnimateCss } from '@vue-interface/animate-css';\nimport { Btn } from '@vue-interface/btn';\nimport { BtnDropdown } from '@vue-interface/btn-dropdown';\nimport { defineComponent } from 'vue';\nimport EditorError from './EditorError.vue';\n\nexport default defineComponent({\n    \n    components: {\n        AnimateCss,\n        Btn,\n        BtnDropdown,\n        ChevronLeftIcon,\n        ChevronRightIcon,\n        EditorError,\n        BugAntIcon,\n        ExclamationTriangleIcon,\n        WrenchScrewdriverIcon\n    },\n\n    props: {\n        saveButton: {\n            type: Boolean,\n            default: true\n        },\n\n        saveButtonLabel: {\n            type: String,\n            default: 'Save File'\n        },\n        \n        view: {\n            type: Object,\n            default: undefined\n        }\n    },\n\n    emits: [\n        'goto',\n        'update:modelValue',\n        'save'\n    ],\n\n    data() {\n        return {\n            currentDiagnostic: undefined,\n            direction: 'up',\n            diagnostics: [],\n            fixedAllDiagnostics: false,\n            hasLinted: false,\n            showFooter: false,\n            showFooterContent: false,\n        };\n    },\n\n    computed: {\n\n        actions() {\n            return this.currentDiagnostic ? []\n                .concat(this.currentDiagnostic.rule.actions)\n                .reverse()\n                .filter(({ validate }: { validate: Function }) => {\n                    return !validate || validate(this.view, this.currentDiagnostic);\n                }) : [];\n        },\n\n        index() {\n            return Math.max(0, this.diagnostics.indexOf(this.currentDiagnostic));\n        },\n\n        totalDiagnostics() {\n            return this.diagnostics.length;\n        }\n\n    },\n\n    watch: {\n\n        currentDiagnostic(value, oldValue) {\n            this.direction = this.index > this.diagnostics.indexOf(oldValue) ? 'down': 'up';\n        },\n\n        diagnostics(value, oldValue) {\n            if(value.length) {\n                this.hasLinted = true;\n                this.fixedAllDiagnostics = false;\n            }\n            else if(!value.length && !!oldValue.length) {\n                this.hasLinted = true;\n                this.currentDiagnostic = null;\n                this.fixedAllDiagnostics = true;\n            }\n            else if(!value.length) {\n                this.fixedAllDiagnostics = true;\n            }\n\n        }\n    },\n\n    updated() {\n        if(!this.isEmpty() && this.hasLinted && (this.saveButton || !this.saveButton && this.diagnostics.length)) {\n            this.showFooter = true;\n            setTimeout(() => this.showFooterContent = true, 200);\n        }\n        else {\n            this.showFooterContent = false;\n            setTimeout(() => this.showFooter = false, 200);\n        }\n    },\n\n    methods: {\n\n        findActiveDiagnostic() {\n            return this.diagnostics\n                .filter((diagnostic: any) => diagnostic.isActive)\n                .pop();\n        },\n\n        goto(index: number) {\n            if(index < 0) {\n                index = this.diagnostics.length - 1;\n            }\n            else if(index > this.diagnostics.length - 1) {\n                index = 0;\n            }\n\n            const lastDiagnostic = this.currentDiagnostic;\n            \n            this.currentDiagnostic = this.diagnostics[index];   \n\n            this.$emit('goto', this.currentDiagnostic, lastDiagnostic);\n        },\n\n        isEmpty() {\n            return this.view ? this.view.state.doc.toString() === '' : false;\n        },\n\n        compare(a: any, b: any) {\n            return (!!a && !!b)\n                && a.from === b.from\n                && a.to === b.to\n                && a.rule.id === b.rule.id;\n        },\n\n        update(diagnostics: any) {\n            this.diagnostics = diagnostics || [];\n            this.hasLinted = true;\n\n            if(!this.currentDiagnostic) {\n                this.currentDiagnostic = this.diagnostics[this.index];\n            }\n            \n            this.$emit('update:modelValue', this.diagnostics);\n        },\n        \n        activate(view: any) {\n            const { from, to } = view.state.selection.main;\n\n            const active = this.diagnostics.filter((diagnostic: any) => {\n                if(from === to) {\n                    return diagnostic.from <= from && diagnostic.to >= to;\n                }\n\n                return diagnostic.from >= from && diagnostic.to <= to;\n            });\n\n            const match = this.diagnostics.find((diagnostic: any) => {\n                return this.compare(diagnostic, this.currentDiagnostic);\n            });\n\n            const index = Math.max(0, active.indexOf(this.currentDiagnostic));\n            \n            if(active.length) {\n                this.currentDiagnostic = active[index];\n            }\n            else {\n                this.currentDiagnostic = match || this.diagnostics[this.index];\n            }\n        },\n\n        onClickAction(diagnostic: any, action: any) {\n            action.apply(this.view, diagnostic.from, diagnostic.to);\n\n            forceLinting(this.view);\n        }\n\n    }\n\n});\n</script>\n\n<template>\n    <footer\n        class=\"editor-footer\"\n        :style=\"{minHeight: !showFooter ? 0 : undefined}\">\n        <animate-css\n            name=\"fade\"\n            :duration=\"200\">\n            <div\n                v-if=\"showFooterContent\"\n                class=\"flex justify-between items-center w-full py-2\">\n                <div class=\"flex items-center w-full overflow-hidden relative gap-2\">\n                    <div class=\"editor-footer-pager\">\n                        <div v-if=\"totalDiagnostics\">\n                            <btn\n                                type=\"button\"\n                                variant=\"link\"\n                                @click=\"goto(index - 1)\">\n                                <ChevronLeftIcon class=\"w-4 h-4\" />\n                            </btn> \n                            <span>{{ index + 1 }} of {{ diagnostics.length }}</span>\n                            <btn\n                                type=\"button\"\n                                variant=\"link\"\n                                @click=\"goto(index + 1)\">\n                                <ChevronRightIcon class=\"w-4 h-4\" />\n                            </btn>\n                        </div>\n                    </div>\n                    <button\n                        v-if=\"currentDiagnostic\"\n                        type=\"button\"\n                        @click=\"goto(index)\">\n                        <BugAntIcon\n                            v-if=\"currentDiagnostic.severity === 'error'\"\n                            class=\"w-6 h-6\" />\n                                \n                        <ExclamationTriangleIcon\n                            v-if=\"currentDiagnostic.severity === 'warning'\"\n                            class=\"w-6 h-6\" />\n                    </button>\n                    <div class=\"editor-footer-diagnostic\">\n                        <animate-css\n                            name=\"fade\"\n                            :duration=\"200\"\n                            :direction=\"direction\"\n                            leave-active-class=\"position-absolute\">\n                            <editor-error\n                                v-if=\"currentDiagnostic\"\n                                :key=\"index\"\n                                :error=\"currentDiagnostic\" />\n                        </animate-css>\n                    </div>\n                </div>\n                <div class=\"editor-footer-action\">\n                    <slot name=\"before-save-button\" />\n\n                    <slot name=\"action-button\">\n                        <template v-if=\"actions.length\">\n                            <template v-if=\"actions.length === 1\">\n                                <btn\n                                    type=\"button\"\n                                    variant=\"light\"\n                                    size=\"sm\"\n                                    class=\"flex items-center gap-2\"\n                                    @click=\"() => onClickAction(currentDiagnostic, actions[0])\">\n                                    <WrenchScrewdriverIcon class=\"w-6 h-6\" /> {{ actions[0].name }}\n                                </btn>\n                            </template>\n                            <template v-else>\n                                <btn-dropdown\n                                    label=\"Fix Errors\"\n                                    type=\"button\"\n                                    size=\"sm\"\n                                    variant=\"light\"\n                                    dropup>\n                                    <button\n                                        v-for=\"(action, i) in actions\"\n                                        :key=\"`${currentDiagnostic.rule.id}-${i}`\"\n                                        type=\"button\"\n                                        variant=\"light\"\n                                        @click=\"() => onClickAction(currentDiagnostic, action)\">\n                                        {{ action.name }}\n                                    </button>\n                                </btn-dropdown>\n                            </template>\n                        </template>\n                    </slot>\n\n                    <slot\n                        name=\"save-button\"\n                        :diagnostics=\"diagnostics\"\n                        :save-button-label=\"diagnostics\">\n                        <btn\n                            v-if=\"saveButton && !diagnostics.length\"\n                            type=\"button\"\n                            variant=\"light\"\n                            size=\"sm\"\n                            @click=\"$emit('save')\">\n                            {{ saveButtonLabel }}\n                        </btn>\n                    </slot>\n\n                    <slot\n                        name=\"after-save-button\"\n                        :diagnostics=\"diagnostics\" />\n                </div>\n            </div>\n        </animate-css>\n    </footer>\n</template>\n\n<style>\n.editor-footer {\n    display: flex;\n    align-items: center;\n    color: white;\n    position: relative;\n    transition: .2s all ease-in;\n}\n\n.editor-footer-content {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    width: 100%;\n    padding: 1rem 0;\n}\n\n.editor-footer-error {\n    display: flex;\n    align-items: center;\n    width: 100%;\n    overflow: hidden;\n    position: relative;\n}\n\n.editor-footer-icon {\n    margin-right: .5rem;\n}\n\n.editor-footer-icon button {\n    color: white;\n    padding: 0 1rem;\n}\n\n.editor-footer-icon button:active {\n    color: #e0e0e0;\n}\n\n.editor-footer-action {\n    flex-shrink: 0;\n    padding-right: .5rem;\n}\n\n.editor-footer-action-icon {\n    margin-right: .25rem;\n}\n\n.editor-footer-diagnostic {\n    font-weight: 300;\n    font-size: .85em;\n    overflow: hidden;\n}\n    \n.editor-footer-pager {\n    flex-shrink: 0;\n    min-width: 10.5rem;\n}\n\n.editor-footer-pager  > div {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 0 .5rem;\n}\n\n.editor-footer-pager .btn {\n    padding: 0;\n    color: white;\n    width: 2rem;\n    height: 1.75rem;\n    font-size: 1.75rem;\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    border-radius: .6666rem;\n    background: transparent;\n    border: 0;\n}\n\n.editor-footer-pager .btn:active {\n    background: rgba(0, 0, 0, .3);\n}\n</style>","<script lang=\"ts\">\nimport { AnimateCss } from '@vue-interface/animate-css';\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n    components: {\n        AnimateCss\n    },\n    props: {\n        bgAnimation: {\n            type: Object,\n            default: () => ({\n                name: 'fade',\n                duration: 500\n            })\n        },\n        contentAnimation: {\n            type: Object,\n            default: () => ({\n                name: 'fade',\n                duration: 500\n            })\n        }\n    },\n    data: () => ({\n        mounted: false,\n        isContentShowing: false,\n        showContent: false,\n    }),\n    watch: {\n        showContent(value) {\n            if(value) {\n                this.$nextTick(() => {\n                    this.isContentShowing = true;\n                });\n            }\n        }\n    },\n    mounted() {\n        this.mounted = true;\n    },\n});\n</script>\n\n<template>\n    <animate-css\n        v-bind=\"bgAnimation\"\n        @after-enter=\"showContent = true\">\n        <div\n            v-if=\"mounted\"\n            class=\"capsule-editor-modal\">\n            <animate-css v-bind=\"contentAnimation\">\n                <div\n                    v-if=\"showContent\"\n                    class=\"capsule-editor-modal-content\">\n                    <slot :is-showing=\"isContentShowing\" />\n                </div>\n            </animate-css>\n        </div>\n    </animate-css>\n</template>\n\n<style>\n.capsule-editor-modal {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    z-index: 1000;\n    background: rgba(0, 0, 0, .3);\n}\n\n.capsule-editor-modal::after  {\n    content: '';\n    width: 100%;\n    height: 100%;\n    background: inherit; \n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 2;\n    background: rgba(41, 91, 150, .8);\n    filter: blur(50rem);\n}\n\n.capsule-editor-modal h1 {\n    font-size: 2rem;\n}\n\n.capsule-editor-modal small, .capsule-editor-modal .small {\n    font-size: .75rem;\n}    \n\n.capsule-editor-modal h1 {\n    margin-bottom: 1rem;\n}\n\n.capsule-editor-modal h5 {\n    font-weight: 300;\n    margin-bottom: 1.5rem;\n    font-size: 1.25rem;\n}\n\n.capsule-editor-modal p {\n    margin-bottom: 1rem;\n}\n\n.capsule-editor-modal .capsule-editor-modal-text {\n    margin: 0 3rem 1rem;\n}\n\n.capsule-editor-modal a {\n    color: #0284c7;\n}\n\n.capsule-editor-modal .text-center { \n    text-align: center;\n}\n\n.capsule-editor-modal a:hover {\n    text-decoration: underline;\n}\n\n.capsule-editor-modal .font-light {\n    font-weight: 300;\n}\n\n.capsule-editor-modal-logo {\n    width: 6rem;\n    margin: 2rem auto;\n    display: flex;\n}\n\n.capsule-editor-modal-content {\n    width: 50%;\n    overflow: auto;\n    min-width: 33rem;\n    max-width: 40rem;\n    max-height: 40rem;\n    background: white;\n    box-shadow: 0 0 30px rgba(0, 0, 0, .5);\n    position: relative;\n    z-index: 10;\n    padding: 1rem;\n}\n\n.capsule-editor-modal .slide-deck-controls {\n    bottom: 1.75rem;\n}\n\n.capsule-editor-modal .slide-deck-control-icon {\n    font-size: .75rem;\n}\n\n.capsule-editor-modal .slide-deck-control-icon:not(.is-active) {\n    color: #e0e0e0;\n}\n\n.capsule-editor-modal-footer {\n    position: absolute;\n    left: 50%;\n    bottom: 0;\n    transform: translateX(-50%);\n}\n\n.capsule-editor-modal-action {\n    text-align: center;\n}\n\n.capsule-editor-modal-action .btn {\n    margin-bottom: .75rem;\n}\n\n.capsule-editor-modal-action small {\n    display: block;\n}\n</style>\n","<script lang=\"ts\">\nimport { QuestionMarkCircleIcon } from '@heroicons/vue/24/outline';\nimport { Btn } from '@vue-interface/btn';\nimport { defineComponent } from 'vue';\n\nexport default defineComponent({\n\n    components: {\n        Btn,\n        QuestionMarkCircleIcon\n    },\n\n    model: {\n        prop: 'currentValue'\n    },\n\n    props: {\n\n        demoMode: Boolean,\n\n        disableFilename: Boolean,\n        \n        filename: {\n            type: String,\n            default: undefined\n        }\n\n    },\n\n    emits: [\n        'demo-modal',\n        'update:filename',\n    ],\n\n    data() {\n        return {\n            currentValue: this.filename\n        };\n    }\n\n});\n</script>\n\n<template>\n    <div class=\"editor-toolbar\">\n        <div class=\"editor-toolbar-left\">\n            <slot name=\"left\" />\n        </div>\n        <div class=\"editor-toolbar-title\">\n            <input\n                v-model=\"currentValue\"\n                type=\"text\"\n                placeholder=\"Untitled Document\"\n                :disabled=\"disableFilename\"\n                @input=\"(event: any) => $emit('update:filename', event.target.value)\">\n        </div>\n        <div class=\"editor-toolbar-right\">\n            <slot name=\"right\">\n                <btn\n                    v-if=\"demoMode\"\n                    size=\"sm\"\n                    variant=\"link\"\n                    class=\"editor-help\"\n                    @click=\"$emit('demo-modal')\">\n                    <QuestionMarkCircleIcon class=\"w-4 h-4\" />\n                </btn>\n            </slot>\n        </div>\n    </div>\n</template>\n\n<style>\n.editor-toolbar {\n    color: white;\n    background-color: #292C33 !important;\n    display: flex;\n    justify-content: space-between;\n    padding: .5rem .5rem .25rem;\n}\n\n.editor-toolbar.fixed {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100%;\n    z-index: 100;\n}\n\n.editor-toolbar .btn {\n    position: relative;\n}\n\n.editor-toolbar .badge {\n    top: 0;\n    right: 0;\n    z-index: 1;\n    transform: translate(50%, -25%);\n}\n\n.editor-toolbar .btn.has-error > svg {\n    color: #9f1239;\n}\n\n.editor-toolbar-title {\n    font-size: 1em;\n    width: auto;\n    background: transparent;\n    text-align: center;\n    margin: 0 auto;\n    display: flex;\n    flex-grow: 1;\n}\n\n.editor-toolbar-title input {\n    border: 0;\n    margin: 0;\n    color: white;\n    outline: none;\n    background: transparent;\n    text-align: center;\n    flex-grow: 1;\n}\n\n.editor-help, .editor-help:hover {\n    font-size: 1.5em;\n    color: #228DFF;\n}\n\n.editor-toolbar-actions .dropdown-item {\n    display: flex;\n    align-items: center;\n}\n\n.editor-toolbar-actions .dropdown-item span {\n    margin-right: 1.5em;\n}\n\n.editor-toolbar-actions .dropdown-item code {\n    font-size: 8px;\n    margin-left: auto;\n}\n\n.editor-toolbar-actions .dropdown-item kbd {\n    background: rgb(60, 60, 60);\n}\n\n.editor-toolbar-actions .dropdown-item kbd:not(:last-child) {\n    margin-right: .25em;\n}\n\n.editor-toolbar-actions .dropdown-item svg {\n    width: 9px;\n}\n</style>\n","import { linter, lintKeymap } from '@codemirror/lint';\nimport { showPanel } from '@codemirror/panel';\nimport { StateEffect, StateField } from '@codemirror/state';\nimport { Decoration, EditorView, WidgetType } from '@codemirror/view';\nimport { lint } from 'capsule-lint';\n\n// Override the default keymaps\n// @ts-ignore\nlintKeymap[0].run = () => {\n    // Ignore the command\n};\n\nclass DiagnosticWidget extends WidgetType {\n    constructor(\n        public diagnostic: any\n    ) {\n        super();\n\n        this.diagnostic = diagnostic;\n    }\n    line(number: number) {\n        this.diagnostic.line = number;\n    }\n    col(number: number) {\n        this.diagnostic.col = number;\n    }\n    from(number: number) {\n        this.diagnostic.from = number;\n    }\n    to(number: number) {\n        this.diagnostic.to = number;\n    }\n    eq(other: any) {\n        return other.diagnostic == this.diagnostic;\n    }\n    toDOM() {\n        return document.createElement('span');\n    }\n    ignoreEvent() {\n        return false; \n    }\n}\n\nclass LintState {\n    constructor(\n        public decorations: any\n    ) {\n        this.decorations = decorations;\n    }\n    get length() {\n        return this.decorations.length;\n    }\n    get diagnostics() {\n        const items: any[] = [];\n        \n        this.iter((iter: any) => {\n            items.push(iter.value);\n        });\n\n        return items.reduce((carry, { widget }) => {\n            if(carry.indexOf(widget.diagnostic) === -1) {\n                carry.push(widget.diagnostic);\n            }\n\n            return carry;\n        }, []);\n    }\n    map(fn: Function) {\n        return this.decorations.map(fn);\n    }\n    iter(fn: Function) {\n        const iter = this.decorations.iter();\n        \n        while(iter.value) {\n            fn(iter);\n            \n            iter.next();\n        }\n    }\n    sync(state: any) {\n        const items: any[] = [];\n\n        this.iter((iter: any) => {\n            if(!iter.value.spec.side) {\n                const line = state.doc.lineAt(iter.from);\n                \n                iter.value.widget.col(iter.from - line.from + 1);\n                iter.value.widget.from(iter.from);\n                iter.value.widget.line(line.number);\n            }\n            else {\n                iter.value.widget.to(iter.to);\n            }\n\n            items.push(iter.value);\n        });\n\n        return items.reduce((carry, { widget }) => {\n            if(carry.indexOf(widget.diagnostic) === -1) {\n                carry.push(widget.diagnostic);\n            }\n\n            return carry;\n        }, []);\n    }\n    static init(diagnostics: any[]) {\n        const mapped = diagnostics.map(diagnostic => {\n            const from = Decoration.widget({\n                widget: new DiagnosticWidget(diagnostic),\n                diagnostic,\n                side: 0,\n            }).range(diagnostic.from);\n\n            const to = Decoration.widget({\n                widget: new DiagnosticWidget(diagnostic),\n                diagnostic,\n                side: 1,\n                from,\n            }).range(diagnostic.to);\n\n            return [\n                from,\n                to\n            ];\n        });\n\n        return new LintState(\n            Decoration.set(mapped.flat(), true)\n        );\n    }\n}\n\nconst setDiagnosticsEffect = StateEffect.define();\n\nconst lintState = StateField.define({\n    create() {\n        return new LintState(Decoration.none);\n    },\n    update(value, tr: any) {\n        if(tr.docChanged && value.length) {\n            return new LintState(value.map(tr.changes));\n        }\n\n        for(const effect of tr.effects) {\n            if(effect.is(setDiagnosticsEffect)) {\n                return LintState.init(effect.value);\n            }\n        }\n\n        return value;\n    },\n    provide(field) {\n        return [\n            linter(view => {\n                const { doc } = view.state.toJSON();\n            \n                const diagnostics = lint(doc).map((error: any) => {\n                    const pos = view.state.doc.line(error.line);\n                    const from  = Math.min(doc.length, pos.from - 1 + error.col);\n                    const to = Math.min(doc.length, from + error.raw.length);\n            \n                    return {\n                        from,\n                        to,\n                        col: error.col,\n                        line: error.line,\n                        rule: error.rule,\n                        message: error.message,\n                        severity: error.type,\n                        source: error.rule.id,\n                    };\n                });\n            \n                view.dispatch({\n                    effects: setDiagnosticsEffect.of(diagnostics)\n                });\n            \n                return diagnostics;\n            }),\n            EditorView.decorations.from(field, state => state.decorations),\n            EditorView.updateListener.of(event => {\n                if(event.docChanged) {\n                    event.state.field(lintState).sync(event.view.state);\n                }\n            })\n        ];\n    }\n});\n\nexport default function(parent: any) {\n    return [\n        lintState,\n        showPanel.of(() => {\n            return {\n                bottom: true,\n                dom: parent.$refs.footer.$el\n            };\n        }),\n        EditorView.updateListener.of(view => {   \n            if(!parent.$refs.footer) {\n                return;\n            }\n                 \n            if(view.docChanged) {\n                parent.$refs.footer.update(\n                    view.state.field(lintState).diagnostics\n                );\n            }\n\n            for(const tr of view.transactions) {\n                for(const effect of tr.effects) {\n                    if(effect.is(setDiagnosticsEffect)) {\n                        parent.$refs.footer.update(\n                            view.state.field(lintState).diagnostics\n                        );\n                    }\n                }\n            }\n\n            parent.$refs.footer.activate(view);\n        }),\n    ];\n}","import { showPanel } from '@codemirror/panel';\nimport { EditorView, ViewPlugin } from '@codemirror/view';\n\nexport default function(parent: any) {\n    return [\n        ViewPlugin.fromClass(class {\n            constructor(view: any) {\n                parent.currentContent = view.state.doc.toString();\n            }\n        }),\n        EditorView.updateListener.of(view => {\n            if(view.docChanged) {\n                parent.currentContent = view.state.doc.toString();\n            }\n        }),\n        showPanel.of(() => ({\n            top: true,\n            dom: parent.$refs.toolbar.$el\n        }))\n    ];\n}","<script lang=\"ts\">\nimport { basicSetup, EditorState } from '@codemirror/basic-setup';\nimport { indentWithTab } from '@codemirror/commands';\nimport { html } from '@codemirror/lang-html';\nimport { EditorSelection } from '@codemirror/state';\nimport { oneDark } from '@codemirror/theme-one-dark';\nimport { EditorView, keymap } from '@codemirror/view';\nimport { Btn } from '@vue-interface/btn';\nimport { defineComponent } from 'vue';\nimport EditorFooter from './EditorFooter.vue';\nimport EditorModal from './EditorModal.vue';\nimport EditorToolbar from './EditorToolbar.vue';\nimport lint from './Extensions/Lint.js';\nimport toolbar from './Extensions/Toolbar.js';\n\nexport default defineComponent({\n    components: {\n        Btn,\n        EditorFooter,\n        EditorModal,\n        EditorToolbar,\n    },\n    // model: {\n    //     prop: 'content'\n    // },\n    props: {\n\n        content: {\n            type: String,\n            default: undefined\n        },\n        \n        demoMode: {\n            type: Boolean,\n            default: false\n        },\n\n        disableFilename: Boolean,\n\n        filename: {\n            type: String,\n            default: null\n        },\n\n        save: {\n            type: Function,\n            default() {\n                return this.showFinishModal = true;\n            }\n        },\n\n        saveButton: {\n            type: Boolean,\n            default: true\n        },\n\n        skipIntro: {\n            type: Boolean,\n            default: false\n        },\n\n        title: {\n            type: String,\n            default: undefined\n        },\n\n        toolbar: {\n            type: Boolean,\n            default: true\n        },\n    },\n    emits: [\n        'demo-complete',\n        'fixed-errors',\n        'update:content',\n        'update:filename'\n    ],\n    data() {\n        return {\n            demoModalCleared: this.skipIntro,\n            errors: [],\n            hasDismissedFinishPopup: false,\n            showFinishModal: false,\n            view: undefined,\n        };\n    },\n    watch: {\n        errors(value, oldErrors) {\n            if(!value.length && oldErrors.length) {\n                this.$emit('fixed-errors');\n            }\n        },\n    },\n    mounted() {\n        this.view = new EditorView({\n            state: EditorState.create({\n                doc: this.content,// || this.getSlotContents(),\n                extensions: [\n                    oneDark,\n                    ...basicSetup,\n                    keymap.of([ indentWithTab ]),\n                    html(),\n                    this.toolbar && toolbar(this),\n                    lint(this),\n                    EditorView.lineWrapping,\n                    EditorView.updateListener.of(view => {\n                        if(view.docChanged) {\n                            this.$emit('update:content', view.state.doc.toString());\n                        }\n                    })\n                ].filter(value => !!value)\n            }),\n            parent: this.$refs.wrapper\n        });\n    },\n    methods: {\n        closeFinishPopup() {\n            this.showFinishModal = false;\n            this.hasDismissedFinishPopup = true;\n        },\n\n        onModalClear() {\n            this.demoModalCleared = true;\n            this.$emit('demo-complete');\n            this.view.focus();\n        },\n        \n        onGoto({ from, to }: { from: number, to:number }) {\n            this.view.dispatch({ \n                selection: EditorSelection.create([\n                    EditorSelection.range(from, to),\n                    EditorSelection.cursor(to)\n                ]),\n                scrollIntoView: true\n            });\n            \n            this.view.focus();\n        },\n\n    \n        onSave() {\n            this.save(this);\n        }\n    }\n});\n</script>\n\n<template>\n    <div class=\"capsule-editor\">\n        <!-- <editor-demo-modal\n            v-if=\"demoMode && !demoModalCleared\"\n            @clear=\"onModalClear\" /> -->\n\n        <editor-modal\n            v-if=\"showFinishModal\"\n            :content-animation=\"{name: 'tada'}\">\n            <template #default=\"{ isShowing }\">\n                <slot\n                    name=\"success\"\n                    :close=\"closeFinishPopup\"\n                    :filename=\"filename\"\n                    :view=\"view\"\n                    :is-showing=\"isShowing\">\n                    <slot\n                        name=\"success-content\"\n                        :content=\"content\"\n                        :close=\"closeFinishPopup\"\n                        :filename=\"filename\"\n                        :view=\"view\">\n                        <div class=\"text-center\">\n                            <h1>\n                                Success!\n                            </h1>\n                            <h5>\n                                Your document has been fixed.\n                            </h5>\n                            <btn\n                                type=\"button\"\n                                variant=\"primary\"\n                                size=\"lg\"\n                                block\n                                @click=\"closeFinishPopup\">\n                                Dismiss\n                            </btn>\n                        </div>\n                    </slot>\n                </slot>\n            </template>\n        </editor-modal>\n\n        <editor-toolbar\n            v-if=\"toolbar\"\n            ref=\"toolbar\"\n            :demo-mode=\"demoMode\"\n            :disable-filename=\"disableFilename\"\n            :filename=\"filename\"\n            @demo-modal=\"() => demoModalCleared = false\"\n            @update:filename=\"value => $emit('update:filename', value)\">\n            <template #left>\n                <slot\n                    name=\"toolbar-left\"\n                    :errors=\"errors\"\n                    :filename=\"filename\"\n                    :content=\"content\" />\n            </template>\n            <template #right>\n                <slot\n                    name=\"toolbar-right\"\n                    :errors=\"errors\"\n                    :filename=\"filename\"\n                    :content=\"content\" />\n            </template>\n        </editor-toolbar>\n\n        <div\n            ref=\"wrapper\"\n            class=\"cm-wrapper\" />\n\n        <editor-footer\n            ref=\"footer\"\n            v-model=\"errors\"\n            :save-button=\"saveButton\"\n            :view=\"view\"\n            @save=\"onSave\"\n            @goto=\"onGoto\">\n            <template #before-save-button>\n                <slot\n                    name=\"before-save-button\"\n                    :errors=\"errors\"\n                    :filename=\"filename\"\n                    :content=\"content\" />\n            </template>\n            <template #save-button>\n                <slot\n                    name=\"save-button\"\n                    :errors=\"errors\"\n                    :filename=\"filename\"\n                    :content=\"content\" />\n            </template>\n            <template #after-save-button>\n                <slot\n                    name=\"after-save-button\"\n                    :errors=\"errors\"\n                    :filename=\"filename\"\n                    :content=\"content\" />\n            </template>\n        </editor-footer>\n    </div>\n</template>\n\n<style>\n.capsule-editor {\n    font-size: 1rem;\n}\n\n.capsule-editor .position-absolute {\n    position: absolute;\n}\n\n.capsule-editor,\n.cm-container,\n.cm-editor,\n.cm-wrapper { height: 100%; }\n.cm-scroller { overflow: auto }\n.cm-editor.cm-focused { outline: none }\n.cm-panels.cm-panels-top { border: none !important; }\n.cm-panels.cm-panels-bottom { border: 1px solid #101114 !important; }\n</style>\n"],"names":["_sfc_main$4","defineComponent","ArrowTopRightOnSquareIcon","_component_ArrowTopRightOnSquareIcon","_resolveComponent","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_toDisplayString","_ctx","_createTextVNode","_sfc_main$3","AnimateCss","Btn","BtnDropdown","ChevronLeftIcon","ChevronRightIcon","EditorError","BugAntIcon","ExclamationTriangleIcon","WrenchScrewdriverIcon","validate","value","oldValue","diagnostic","index","lastDiagnostic","a","b","diagnostics","view","from","to","active","match","action","forceLinting","_hoisted_4","_normalizeStyle","_component_animate_css","_withCtx","_hoisted_2","_hoisted_3","_createVNode","_component_btn","_cache","$event","_createCommentVNode","_createBlock","_component_BugAntIcon","_component_ExclamationTriangleIcon","_hoisted_5","_component_editor_error","_hoisted_6","_renderSlot","_Fragment","_component_WrenchScrewdriverIcon","_component_btn_dropdown","_renderList","i","_sfc_main$2","_normalizeProps","_guardReactiveProps","_sfc_main$1","QuestionMarkCircleIcon","_withDirectives","event","lintKeymap","DiagnosticWidget","WidgetType","number","other","LintState","decorations","items","iter","carry","widget","fn","state","line","mapped","Decoration","setDiagnosticsEffect","StateEffect","lintState","StateField","tr","effect","field","linter","doc","lint","error","pos","EditorView","parent","showPanel","toolbar","ViewPlugin","_sfc_main","EditorFooter","EditorModal","EditorToolbar","oldErrors","EditorState","oneDark","basicSetup","keymap","indentWithTab","html","EditorSelection","_component_editor_modal","isShowing","_component_editor_toolbar","_component_editor_footer"],"mappings":"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"}